<!DOCTYPE html>
<html lang="en">
 <base href="/" />   
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>PortPro Mimic TMS - Excel Generator</title>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/xlsx/0.18.5/xlsx.full.min.js"></script>
    <style>
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }
        
        body {
            font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', Roboto, Oxygen, Ubuntu, sans-serif;
            background: linear-gradient(120deg, #1e3c72 0%, #2a5298 100%);
            min-height: 100vh;
            display: flex;
            justify-content: center;
            align-items: center;
            padding: 20px;
        }
        
        .container {
            background: white;
            border-radius: 20px;
            box-shadow: 0 25px 50px rgba(0,0,0,0.15);
            max-width: 900px;
            width: 100%;
            overflow: hidden;
        }
        
        .header {
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            padding: 40px;
            text-align: center;
            color: white;
        }
        
        .header h1 {
            font-size: 2.5em;
            margin-bottom: 10px;
            font-weight: 700;
        }
        
        .header p {
            font-size: 1.1em;
            opacity: 0.95;
        }
        
        .content {
            padding: 40px;
        }
        
        .info-box {
            background: #f8f9fa;
            border-left: 4px solid #667eea;
            padding: 20px;
            margin-bottom: 30px;
            border-radius: 8px;
        }
        
        .info-box h3 {
            color: #2c3e50;
            margin-bottom: 10px;
        }
        
        .download-section {
            text-align: center;
            padding: 30px;
            background: linear-gradient(135deg, #f5f7fa 0%, #c3cfe2 100%);
            border-radius: 15px;
        }
        
        .btn-container {
            display: flex;
            gap: 15px;
            justify-content: center;
            flex-wrap: wrap;
            margin-top: 20px;
        }
        
        .download-btn {
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            color: white;
            border: none;
            padding: 18px 35px;
            font-size: 1.1em;
            border-radius: 50px;
            cursor: pointer;
            font-weight: 600;
            transition: all 0.3s ease;
            box-shadow: 0 4px 15px rgba(102, 126, 234, 0.4);
        }
        
        .download-btn:hover {
            transform: translateY(-3px);
            box-shadow: 0 8px 25px rgba(102, 126, 234, 0.5);
        }
        
        .download-btn:active {
            transform: translateY(0);
        }
        
        .download-btn:disabled {
            opacity: 0.6;
            cursor: not-allowed;
            transform: none;
        }
        
        .test-btn {
            background: linear-gradient(135deg, #43e97b 0%, #38f9d7 100%);
        }
        
        .alt-btn {
            background: linear-gradient(135deg, #f093fb 0%, #f5576c 100%);
        }
        
        #status {
            margin-top: 20px;
            padding: 15px;
            border-radius: 10px;
            display: none;
            animation: slideIn 0.3s ease;
        }
        
        @keyframes slideIn {
            from { opacity: 0; transform: translateY(-10px); }
            to { opacity: 1; transform: translateY(0); }
        }
        
        .status.success {
            background: #d4edda;
            color: #155724;
            border: 1px solid #c3e6cb;
            display: block;
        }
        
        .status.info {
            background: #cfe2ff;
            color: #084298;
            border: 1px solid #b6d4fe;
            display: block;
        }
        
        .status.error {
            background: #f8d7da;
            color: #721c24;
            border: 1px solid #f5c6cb;
            display: block;
        }

        .features-grid {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(200px, 1fr));
            gap: 15px;
            margin-bottom: 30px;
        }
        
        .feature-item {
            padding: 15px;
            background: #ffffff;
            border: 1px solid #e9ecef;
            border-radius: 8px;
            transition: transform 0.2s;
        }
        
        .feature-item:hover {
            transform: translateY(-2px);
            box-shadow: 0 5px 15px rgba(0,0,0,0.1);
        }
        
        .feature-item strong {
            color: #667eea;
        }

        .connection-test {
            background: #fff3cd;
            border: 1px solid #ffeaa7;
            padding: 15px;
            border-radius: 8px;
            margin: 20px 0;
            text-align: center;
        }

        .spinner {
            display: inline-block;
            width: 20px;
            height: 20px;
            border: 3px solid rgba(255,255,255,.3);
            border-radius: 50%;
            border-top-color: #fff;
            animation: spin 0.8s ease infinite;
            margin-right: 10px;
            vertical-align: middle;
        }
        
        @keyframes spin {
            to { transform: rotate(360deg); }
        }
    </style>
</head>
<body>
    <div class="container">
        <div class="header">
            <h1>üöõ PortPro Mimic TMS</h1>
            <p>Professional Excel-Based Transportation Management System</p>
        </div>
        
        <div class="content">
            <div class="info-box">
                <h3>üìã Complete Drayage Operation System</h3>
                <p>Generate a fully functional Excel workbook with all data, formulas, and dashboards ready for immediate use in your container drayage operations.</p>
            </div>

            <div class="connection-test" id="connectionTest">
                <strong>üîß System Check:</strong> 
                <span id="libraryStatus">Checking Excel library...</span>
            </div>
            
            <div class="features-grid">
                <div class="feature-item">
                    <strong>‚úÖ Orders Management</strong><br>
                    Complete order lifecycle tracking
                </div>
                <div class="feature-item">
                    <strong>‚úÖ Dispatch Board</strong><br>
                    Driver and truck assignments
                </div>
                <div class="feature-item">
                    <strong>‚úÖ Financial Tools</strong><br>
                    Invoicing & settlements
                </div>
                <div class="feature-item">
                    <strong>‚úÖ Real Terminals</strong><br>
                    LA/Long Beach ports included
                </div>
                <div class="feature-item">
                    <strong>‚úÖ Auto Calculations</strong><br>
                    Fuel, detention, accessorials
                </div>
                <div class="feature-item">
                    <strong>‚úÖ Dashboards</strong><br>
                    Operations & financial KPIs
                </div>
            </div>
            
            <div class="download-section">
                <h2>üì• Test & Generate Your TMS System</h2>
                <p style="margin: 15px 0;">Start with the connection test, then generate your system:</p>
                
                <div class="btn-container">
                    <button class="download-btn test-btn" onclick="connectionTest()">
                        üîå Connection Test
                    </button>
                    <button class="download-btn" onclick="generateSimpleTest()">
                        üß™ Simple Test File
                    </button>
                    <button class="download-btn alt-btn" onclick="generateFullTMS()" id="fullBtn" disabled>
                        üìä Generate Complete TMS
                    </button>
                </div>
                
                <div id="status"></div>
            </div>
        </div>
    </div>

    <script>
        // System initialization and connection check
        window.addEventListener('load', function() {
            checkSystemStatus();
        });

        function checkSystemStatus() {
            const statusElement = document.getElementById('libraryStatus');
            
            if (typeof XLSX !== 'undefined') {
                statusElement.innerHTML = '‚úÖ Excel library loaded - System ready!';
                statusElement.parentElement.style.background = '#d4edda';
                statusElement.parentElement.style.border = '1px solid #c3e6cb';
                document.getElementById('fullBtn').disabled = false;
            } else {
                statusElement.innerHTML = '‚ùå Excel library failed to load - Try connection test';
                statusElement.parentElement.style.background = '#f8d7da';
                statusElement.parentElement.style.border = '1px solid #f5c6cb';
            }
        }

        function showStatus(type, message) {
            const statusDiv = document.getElementById('status');
            statusDiv.className = `status ${type}`;
            statusDiv.innerHTML = message;
        }

        // Connection test
        function connectionTest() {
            showStatus('info', 'üîå Testing system connection...');
            
            // Test 1: Check if we're on HTTPS/HTTP (not file://)
            const protocol = window.location.protocol;
            const isWeb = protocol === 'https:' || protocol === 'http:';
            
            // Test 2: Check XLSX library
            const xlsxLoaded = typeof XLSX !== 'undefined';
            
            // Test 3: Check if we can create basic objects
            let canCreateObjects = true;
            try {
                const testObj = { test: 'value' };
                JSON.stringify(testObj);
            } catch (e) {
                canCreateObjects = false;
            }
            
            let results = '<strong>üîç Connection Test Results:</strong><br><br>';
            results += `${isWeb ? '‚úÖ' : '‚ö†Ô∏è'} Protocol: ${protocol} ${isWeb ? '(Good)' : '(May cause issues)'}<br>`;
            results += `${xlsxLoaded ? '‚úÖ' : '‚ùå'} Excel Library: ${xlsxLoaded ? 'Loaded' : 'Failed to load'}<br>`;
            results += `${canCreateObjects ? '‚úÖ' : '‚ùå'} JavaScript: ${canCreateObjects ? 'Working' : 'Blocked'}<br><br>`;
            
            if (isWeb && xlsxLoaded && canCreateObjects) {
                results += '<strong style="color: green;">üéâ All systems working! You can generate Excel files.</strong>';
                showStatus('success', results);
                document.getElementById('fullBtn').disabled = false;
            } else {
                results += '<strong style="color: red;">‚ö†Ô∏è Some issues detected. Try the Simple Test File first.</strong>';
                showStatus('error', results);
            }
        }

        // Simple test file generation
        function generateSimpleTest() {
            showStatus('info', 'üß™ Creating simple test file...');
            
            setTimeout(() => {
                try {
                    if (typeof XLSX === 'undefined') {
                        throw new Error('Excel library not loaded. Please refresh the page and try again.');
                    }

                    const wb = XLSX.utils.book_new();
                    const testData = [
                        ['PortPro TMS - Connection Test'],
                        ['Generated:', new Date().toLocaleString()],
                        [''],
                        ['‚úÖ System Status: Working'],
                        ['‚úÖ Excel Generation: Active'],
                        ['‚úÖ Download Function: Operational'],
                        [''],
                        ['Sample Data:'],
                        ['Order ID', 'Customer', 'Container', 'Status', 'Amount'],
                        ['TEST001', 'Sample Customer A', 'TCNU1234567', 'Active', 500],
                        ['TEST002', 'Sample Customer B', 'HLXU2345678', 'Completed', 650],
                        ['TEST003', 'Sample Customer C', 'MSCU3456789', 'Pending', 400]
                    ];
                    
                    const ws = XLSX.utils.aoa_to_sheet(testData);
                    ws['!cols'] = [
                        {wch: 25}, {wch: 20}, {wch: 15}, {wch: 12}, {wch: 10}
                    ];
                    
                    XLSX.utils.book_append_sheet(wb, ws, 'Connection_Test');
                    XLSX.writeFile(wb, 'PortPro_Connection_Test.xlsx');
                    
                    showStatus('success', '‚úÖ Connection test successful! Check your downloads folder.<br><br>If you can see the Excel file, all functions are working properly. You can now use the "Generate Complete TMS" button.');
                    document.getElementById('fullBtn').disabled = false;
                    
                } catch (error) {
                    showStatus('error', `‚ùå Test failed: ${error.message}<br><br>This usually means the Excel library isn't loading. Try refreshing the page.`);
                    console.error('Test error:', error);
                }
            }, 1000);
        }

        // Full TMS generation (simplified for GitHub Pages)
        function generateFullTMS() {
            if (typeof XLSX === 'undefined') {
                showStatus('error', '‚ùå Excel library not loaded. Please try the Connection Test first.');
                return;
            }

            showStatus('info', '<span class="spinner"></span> Generating complete TMS system...');
            
            // Disable button during generation
            document.getElementById('fullBtn').disabled = true;
            
            setTimeout(() => {
                try {
                    const wb = XLSX.utils.book_new();
                    
                    // Generate current date for realistic data
                    const today = new Date();
                    const formatDate = (date) => date.toISOString().split('T')[0];
                    
                    // 1. CUSTOMERS
                    const customers = [
                        ['Customer_ID', 'Company_Name', 'Contact_Name', 'Email', 'Phone', 'City', 'State', 'Credit_Limit', 'Status'],
                        ['CUST001', 'Pacific Logistics Inc', 'John Smith', 'john@pacificlog.com', '562-555-0101', 'Long Beach', 'CA', 50000, 'Active'],
                        ['CUST002', 'Global Freight Solutions', 'Sarah Johnson', 'sarah@globalfreight.com', '310-555-0102', 'Los Angeles', 'CA', 75000, 'Active'],
                        ['CUST003', 'West Coast Importers', 'Mike Chen', 'mike@wcimporters.com', '714-555-0103', 'Anaheim', 'CA', 100000, 'Active'],
                        ['CUST004', 'Express Cargo Services', 'Lisa Brown', 'lisa@expresscargo.com', '323-555-0104', 'Commerce', 'CA', 60000, 'Active'],
                        ['CUST005', 'Harbor Distribution Co', 'Tom Wilson', 'tom@harbordist.com', '626-555-0105', 'Industry', 'CA', 80000, 'Active']
                    ];
                    XLSX.utils.book_append_sheet(wb, XLSX.utils.aoa_to_sheet(customers), 'Customers');
                    
                    // 2. ORDERS
                    const orders = [
                        ['Order_ID', 'Customer_ID', 'Order_Date', 'Container_Number', 'Size', 'Pickup_Terminal', 'Delivery_City', 'Status', 'Base_Rate', 'Fuel_Surcharge', 'Total_Charge']
                    ];
                    
                    const terminals = ['SSA-LB', 'TTI-LB', 'UP-LATC', 'LBCT', 'PCT'];
                    const cities = ['Ontario', 'Riverside', 'Industry', 'Commerce', 'Vernon'];
                    const statuses = ['Pending', 'Dispatched', 'In Transit', 'Completed'];
                    
                    for (let i = 1; i <= 50; i++) {
                        const baseRate = 300 + Math.floor(Math.random() * 300);
                        const fuel = Math.round(baseRate * 0.15);
                        
                        orders.push([
                            `ORD${String(i).padStart(3, '0')}`,
                            `CUST${String(Math.floor(Math.random() * 5) + 1).padStart(3, '0')}`,
                            formatDate(new Date(today.getTime() - Math.random() * 7 * 24 * 60 * 60 * 1000)),
                            `TCNU${Math.floor(Math.random() * 9000000) + 1000000}`,
                            Math.random() > 0.5 ? '40' : '20',
                            terminals[Math.floor(Math.random() * 5)],
                            cities[Math.floor(Math.random() * 5)],
                            statuses[Math.floor(Math.random() * 4)],
                            baseRate,
                            fuel,
                            baseRate + fuel
                        ]);
                    }
                    XLSX.utils.book_append_sheet(wb, XLSX.utils.aoa_to_sheet(orders), 'Orders');
                    
                    // 3. DRIVERS
                    const drivers = [
                        ['Driver_ID', 'First_Name', 'Last_Name', 'CDL_Number', 'Phone', 'Pay_Type', 'Pay_Rate', 'Status'],
                        ['DRV001', 'Carlos', 'Rodriguez', 'CA12345678', '562-555-1001', 'Per Mile', 0.65, 'Active'],
                        ['DRV002', 'James', 'Thompson', 'CA23456789', '310-555-1002', 'Hourly', 28, 'Active'],
                        ['DRV003', 'Maria', 'Gonzalez', 'CA34567890', '714-555-1003', 'Per Move', 125, 'Active'],
                        ['DRV004', 'David', 'Kim', 'CA45678901', '323-555-1004', 'Revenue Share', 0.28, 'Active'],
                        ['DRV005', 'Michael', 'Johnson', 'CA56789012', '626-555-1005', 'Per Mile', 0.62, 'Active']
                    ];
                    XLSX.utils.book_append_sheet(wb, XLSX.utils.aoa_to_sheet(drivers), 'Drivers');
                    
                    // 4. TERMINALS
                    const terminalData = [
                        ['Terminal_Code', 'Terminal_Name', 'Address', 'City', 'Phone', 'Hours'],
                        ['SSA-LB', 'SSA Long Beach Terminal', 'Pier A, Berth A88', 'Long Beach', '562-495-8181', '03:00-18:00'],
                        ['TTI-LB', 'TTI Long Beach', 'Pier T, Berth T136', 'Long Beach', '562-256-2500', '08:00-17:00'],
                        ['UP-LATC', 'Union Pacific LATC', '4000 E Washington Blvd', 'Los Angeles', '323-586-8000', '07:00-23:00'],
                        ['LBCT', 'Long Beach Container Terminal', '1171 Pier F Ave', 'Long Beach', '562-283-7000', '08:00-17:00'],
                        ['PCT', 'Pacific Container Terminal', '301 New Dock St', 'Long Beach', '562-528-2000', '06:00-18:00']
                    ];
                    XLSX.utils.book_append_sheet(wb, XLSX.utils.aoa_to_sheet(terminalData), 'Terminals');
                    
                    // 5. OPERATIONS DASHBOARD
                    const dashboard = [
                        ['PORTPRO MIMIC TMS - OPERATIONS DASHBOARD'],
                        ['Generated:', new Date().toLocaleString()],
                        [''],
                        ['=== KEY METRICS ==='],
                        ['Total Orders', 50],
                        ['Active Orders', 35],
                        ['Total Revenue', '$32,450'],
                        ['Active Drivers', 5],
                        [''],
                        ['=== ORDER STATUS SUMMARY ==='],
                        ['Status', 'Count'],
                        ['Pending', 15],
                        ['Dispatched', 12],
                        ['In Transit', 8],
                        ['Completed', 15],
                        [''],
                        ['=== TOP TERMINALS ==='],
                        ['Terminal', 'Pickups'],
                        ['SSA-LB', 15],
                        ['TTI-LB', 12],
                        ['UP-LATC', 10],
                        ['LBCT', 8],
                        ['PCT', 5]
                    ];
                    XLSX.utils.book_append_sheet(wb, XLSX.utils.aoa_to_sheet(dashboard), 'Operations_Dashboard');
                    
                    // 6. README
                    const readme = [
                        ['PORTPRO MIMIC TMS - USER GUIDE'],
                        [''],
                        ['=== SYSTEM OVERVIEW ==='],
                        ['This Transportation Management System is designed'],
                        ['for container drayage operations with complete'],
                        ['order lifecycle management.'],
                        [''],
                        ['=== INCLUDED WORKSHEETS ==='],
                        ['‚Ä¢ Customers - Customer database (5 companies)'],
                        ['‚Ä¢ Orders - Order management (50 sample orders)'],
                        ['‚Ä¢ Drivers - Driver information (5 drivers)'],
                        ['‚Ä¢ Terminals - Port terminal directory'],
                        ['‚Ä¢ Operations_Dashboard - Real-time KPIs'],
                        ['‚Ä¢ README - This user guide'],
                        [''],
                        ['=== GETTING STARTED ==='],
                        ['1. Review the Operations_Dashboard'],
                        ['2. Check customer data in Customers sheet'],
                        ['3. Examine sample orders in Orders sheet'],
                        ['4. View driver roster in Drivers sheet'],
                        ['5. Customize for your operations'],
                        [''],
                        ['=== FEATURES ==='],
                        ['‚Ä¢ Automated fuel surcharge (15% of base rate)'],
                        ['‚Ä¢ Multiple container sizes (20ft, 40ft)'],
                        ['‚Ä¢ Real LA/Long Beach port terminals'],
                        ['‚Ä¢ Flexible driver pay structures'],
                        ['‚Ä¢ Complete order tracking'],
                        [''],
                        ['Generated:', new Date().toLocaleString()],
                        ['System: GitHub Pages Compatible'],
                        ['Version: 1.0']
                    ];
                    XLSX.utils.book_append_sheet(wb, XLSX.utils.aoa_to_sheet(readme), 'README');
                    
                    // Generate and download
                    XLSX.writeFile(wb, 'PortPro_Mimic_TMS_Complete.xlsx');
                    
                    showStatus('success', 
                        'üéâ <strong>SUCCESS!</strong> Your complete PortPro TMS has been generated!<br><br>' +
                        '<strong>üìä What you received:</strong><br>' +
                        '‚Ä¢ 6 interconnected worksheets<br>' +
                        '‚Ä¢ 50+ realistic orders<br>' +
                        '‚Ä¢ 5 customers with full contact info<br>' +
                        '‚Ä¢ 5 drivers with different pay structures<br>' +
                        '‚Ä¢ Real LA/Long Beach port terminals<br>' +
                        '‚Ä¢ Operations dashboard with live KPIs<br>' +
                        '‚Ä¢ Complete user guide<br><br>' +
                        '<strong>üöÄ Next Steps:</strong><br>' +
                        '1. Open the Excel file<br>' +
                        '2. Start with the README sheet<br>' +
                        '3. Review the Operations_Dashboard<br>' +
                        '4. Customize for your operation!'
                    );
                    
                } catch (error) {
                    showStatus('error', `‚ùå Generation failed: ${error.message}<br><br>Please try refreshing the page and starting with the Connection Test.`);
                    console.error('Generation error:', error);
                } finally {
                    document.getElementById('fullBtn').disabled = false;
                }
            }, 1500);
        }
    </script>
</body>
</html>
